<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=E26C1359372FE948C3C39B3F0FB94413" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/007decc8-6c12-4163-b4b5-9d2256e5c10eCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=76DF6246C5394201214B48DD1A8F406B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>.Net Implementation of a Priority Queue (aka Heap)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>.Net Implementation of a Priority Queue (aka Heap)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            .NET Framework
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            IEnumerable, Data Structures, PriorityQueue
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">6/16/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Net-Implementation-of-a-d3ac7b9d">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p>The code represents an F# .Net implementation of a Priority Queue; implemented using a heap data structure. Conceptually once can think of a heap as a balanced binary tree. The tree will have a root, and each node can have up to two children; a left and
 a right child. The keys in such a binary tree are said to be in heap order, such that any element is at least as large as its parent element.</p>
<p><span style="font-family:Consolas"><span style="font-size:x-small"><em>For every element v, at a node i, the element w at i&rsquo;s parent satisfies</em> key(w)&le;key(v)</span></span></p>
<p>The heap is maintained as an array, indexed by i=1&hellip;N, such that for any node i, the nodes at positions
<span style="font-family:Consolas">leftChild(i)=2i</span> and <span style="font-family:Consolas">
rightChild(i)=2i&#43;1</span>, and the parent of the node is at position <span style="font-family:Consolas">
parent(i)=(1/2)</span>.</p>
<p>The idea behind a Priority Queue is that finding the element with the lowest key is easy,
<span style="font-family:Consolas">O(<em>1</em>)</span> time, as it is always the root. When adding a new element it is always added to the end of the list. The heap is then fixed by recursively checking the new element with its parent, and swapping their positions
 in the list until the heap condition is satisfied. This operation takes <span style="font-family:Consolas">
O(log <em>n</em>)</span> time.</p>
<p>Within .Net we implemented a Priority Queue using a <span style="font-family:Consolas">
List&lt;KeyValuePair&lt;'TKey, 'TValue&gt;&gt;</span>.</p>
<p>The basic operations supported on the Priority Queue will be:</p>
<table border="1" cellspacing="0" cellpadding="1" width="491">
<tbody>
<tr>
<td width="142" valign="top"><em>Enqueue</em></td>
<td width="347" valign="top">Adds an item to the Queue</td>
</tr>
<tr>
<td width="142" valign="top"><em>Dequeue</em></td>
<td width="347" valign="top">Removes the root element; that with the lowest key</td>
</tr>
<tr>
<td width="142" valign="top"><em>Peek</em></td>
<td width="347" valign="top">Queries the root element</td>
</tr>
<tr>
<td width="142" valign="top"><em>IndexOf</em></td>
<td width="347" valign="top">Returns the index of a given key value pair</td>
</tr>
<tr>
<td width="142" valign="top"><em>RemoveAt</em></td>
<td width="347" valign="top">Removes the element at the specified index value</td>
</tr>
<tr>
<td width="142" valign="top"><em>ContainsKey</em></td>
<td width="347" valign="top">Determines whether the Queue contains a specific key value</td>
</tr>
<tr>
<td width="142" valign="top"><em>GetValues</em></td>
<td width="347" valign="top">Gets the values for a specified key</td>
</tr>
<tr>
<td width="142" valign="top"><em>ChangeKey</em></td>
<td width="347" valign="top">Changes a specific key value</td>
</tr>
<tr>
<td width="142" valign="top"><em>RemoveKey</em></td>
<td width="347" valign="top">Removes the element with the specific key value</td>
</tr>
<tr>
<td width="142" valign="top"><em>Item</em></td>
<td width="347" valign="top">An indexer based on the index values</td>
</tr>
<tr>
<td width="142" valign="top"><em>Merge</em></td>
<td width="347" valign="top">Merges an Enumerable with the Queue</td>
</tr>
</tbody>
</table>
<p>A&nbsp;quick word is warranted about the implementation. The Key operations shown above rely on a second data structure; a
<span style="font-family:Consolas">Dictionary&lt;'TKey, int&gt;</span>. This secondary data structure maintains a reference of the index within the list for each key. This positional structure uses a list off index values associated with each key, allowing
 items with the same key value to be added to the queue.</p>
<p>Specifics of the code can also be found on my blog at:</p>
<p><a href="http://blogs.msdn.com/b/carlnol/archive/2012/05/03/net-implementation-of-a-priority-queue-aka-heap.aspx">http://blogs.msdn.com/b/carlnol/archive/2012/05/03/net-implementation-of-a-priority-queue-aka-heap.aspx</a></p>
<p>Version History:</p>
<p>1. Base Version</p>
<p>2. Implemented Merge operations</p>
<p>3. Allowed same key value</p>

</div>


    </div>
</body>
</html>
